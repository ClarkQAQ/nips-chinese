NIP-A0
======

语音消息
-----------

**状态：** 草案

此 NIP 定义了新事件 `kind: 1222` 用于根消息和 `kind: 1244` 用于回复消息，用于短语音消息，通常长度不超过 60 秒。

## 规范

### 事件类型 `1222` 和类型 `1244`

`kind: 1222` 事件定义如下：

-   `content`：必须是直接指向音频文件的 URL。
    -   音频文件应该是使用 AAC 或 Opus 编码的 `audio/mp4`（.m4a）格式。客户端可以支持其他常见音频格式，如 `audio/ogg`、`audio/webm` 或 `audio/mpeg`（mp3），但推荐使用 `audio/mp4` 以获得广泛的兼容性和效率。
    -   音频持续时间应该不超过 60 秒。发布 `kind: 1222` 事件的客户端应该强制执行此限制，或者在超出时向用户提供明确的警告。
-   `tags`：
    -   可以按照其他 NIP 包含标签（例如，`t` 用于主题标签，`g` 用于地理哈希等）。

  `kind: 1244` 事件定义如下：
  
-    用于回复，`kind: 1244` 事件必须遵循 `NIP-22` 的结构。
-   `content`：必须是直接指向音频文件的 URL。
    -   音频文件应该是使用 AAC 或 Opus 编码的 `audio/mp4`（.m4a）格式。客户端可以支持其他常见音频格式，如 `audio/ogg`、`audio/webm` 或 `audio/mpeg`（mp3），但推荐使用 `audio/mp4` 以获得广泛的兼容性和效率。
    -   音频持续时间应该不超过 60 秒。发布 `kind: 1222` 事件的客户端应该强制执行此限制，或者在超出时向用户提供明确的警告。
-   `tags`：
    -   可以按照其他 NIP 包含标签（例如，`t` 用于主题标签，`g` 用于地理哈希等）。


## 使用 `imeta`（NIP-92）标签进行视觉表示（可选）

可以包含以下 imeta（NIP-92）标签，以便客户端可以在不必先下载音频文件的情况下渲染视觉预览：

- `waveform`：随时间变化的振幅值，空格分隔的完整整数，少于 100 个值应该足以渲染出漂亮的视觉效果
- `duration`：音频长度（以秒为单位）

## 示例

### 根语音消息示例

```json
{
  "content": "https://blossom.primal.net/5fe7df0e46ee6b14b5a8b8b92939e84e3ca5e3950eb630299742325d5ed9891b.mp4",
  "created_at": 1752501052,
  "id": "...",
  "kind": 1222,
  "pubkey": "...",
  "sig": "...",
  "tags": [
    [
      "imeta",
      "url https://blossom.primal.net/5fe7df0e46ee6b14b5a8b8b92939e84e3ca5e3950eb630299742325d5ed9891b.mp4",
      "waveform 0 7 35 8 100 100 49 8 4 16 8 10 7 2 20 10 100 100 100 100 100 100 15 100 100 100 25 60 5 4 3 1 0 100 100 15 100 29 88 0 33 11 39 100 100 19 4 100 42 35 5 0 1 5 0 0 11 38 100 94 17 11 44 58 5 100 100 100 55 14 72 100 100 57 6 1 14 2 16 100 100 40 16 100 100 6 32 14 13 41 36 16 14 6 3 0 1 2 1 6 0",
      "duration 8"
    ]
  ]
}
