NIP-B7
======

Blossom 媒体
-------------

`草案` `可选`

此 NIP 指定 Nostr 客户端如何使用 [Blossom][] 处理媒体。

Blossom 是一套用于处理存储可通过 SHA-256 校验和寻址的文件的服务器的标准（称为 BUD）。Nostr 客户端可以使用所有 BUD 来允许用户上传文件、管理自己的文件等，但最重要的是，Nostr 客户端应该使用 [BUD-03][] 为每个用户获取 `kind:10063` 服务器列表：

```json
{
  "id": "e4bee088334cb5d38cff1616e964369c37b6081be997962ab289d6c671975d71",
  "pubkey": "781208004e09102d7da3b7345e64fd193cd1bc3fce8fdae6008d77f9cabcd036",
  "content": "",
  "kind": 10063,
  "created_at": 1708774162,
  "tags": [
    ["server", "https://blossom.self.hosted"],
    ["server", "https://cdn.blossom.cloud"]
  ],
  "sig": "cc5efa74f59e80622c77cacf4dd62076bcb7581b45e9acff471e7963a1f4d8b3406adab5ee1ac9673487480e57d20e523428e60ffcc7e7a904ac882cfccfc653"
}
```

每当 Nostr 客户端在给定用户发布的事件中找到 URL，并且该 URL 以 64 字符十六进制字符串结尾（带或不带结尾文件扩展名）且该 URL 不再可用时，这意味着该字符串可能是 sha256 的表示，并且用户可能发布了 Blossom 服务器的 `kind:10063` 列表。

鉴于此，客户端应该查看 `kind:10063` 列表中的其他 Blossom 服务器，并通过仅使用十六进制字符串作为路径（可选地在末尾添加文件扩展名）在其中查找相同的 64 字符十六进制字符串，生成类似 `https://blossom.self.hosted/<hex-string>.png` 的 URL。

下载此类文件时，Nostr 客户端应该验证其内容的 sha256 哈希是否与 64 字符十六进制字符串匹配。

更多信息可以在 [BUD-03][] 中找到。

### 更复杂的交互

客户端可以使用 Blossom 服务器提供的其他功能（例如，检查文件是否存在于 Blossom 服务器中，而不是实际下载它），这些功能在 [BUD][Blossom] 中有更好的文档记录。

[Blossom]: https://github.com/hzrd149/blossom
[BUD-03]: https://github.com/hzrd149/blossom/blob/master/buds/03.md
