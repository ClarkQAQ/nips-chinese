NIP-22
======

评论
-------

`草案` `可选`

评论是一个主题笔记，总是限定在根事件或 [`I` 标签](73_ZH.md) 的范围内。

它使用 `kind:1111`，内容为纯文本 `.content`（无 HTML、Markdown 或其他格式）。

评论必须使用大写标签名称（例如 `K`、`E`、`A` 或 `I`）指向根范围，
并且必须使用小写标签名称（例如 `k`、`e`、`a` 或 `i`）指向父项。

当有作者可用时（即标记 nostr 事件），评论必须指向作者。根范围使用 `P`，
父项作者使用 `p`。

```jsonc
{
  "kind": 1111,
  "content": "<评论>",
  "tags": [
    // 根范围：事件地址、事件 ID 或 I 标签。
    ["<A, E, I>", "<地址、ID 或 I 值>", "<中继器或网页提示>", "<根事件的公钥，如果是 E 标签>"],
    // 根项种类
    ["K", "<根种类>"],

    // 根范围事件作者的公钥
    ["P", "<根公钥>", "中继器URL提示"],

    // 父项：事件地址、事件 ID 或 i 标签。
    ["<a, e, i>", "<地址、ID 或 i 值>", "<中继器或网页提示>", "<父事件的公钥，如果是 e 标签>"],
    // 父项种类
    ["k", "<父评论种类>"],

    // 父项公钥
    ["p", "<父公钥>", "中继器URL提示"]
  ]
  // 其他字段
}
```

标签 `K` 和 `k` 必须存在以定义根项和父项的事件种类。

`I` 和 `i` 标签为标签、地理哈希、URL 和其他外部标识符创建范围。

`i` 标签的可能值——以及与外部身份相关的 `k` 标签——列在 [NIP-73](73_ZH.md) 中。
它们的大写版本使用相同类型的值，但涉及根项而不是父项。

当在 `.content` 中引用事件时，可以使用 `q` 标签与 [NIP-21](21_ZH.md)。

```json
["q", "<事件ID> 或 <事件地址>", "<中继器URL>", "<如果是常规事件的公钥>"]
```

当在 `.content` 中提及公钥时，应该使用 `p` 标签与 [NIP-21](21_ZH.md)。

评论不得用于回复种类 1 笔记。应该遵循 [NIP-10](10_ZH.md)。

## 示例

对博客文章的评论如下所示：

```jsonc
{
  "kind": 1111,
  "content": "很棒的博客文章！",
  "tags": [
    // 顶级评论范围到事件地址或 ID
    ["A", "30023:3c9849383bdea883b0bd16fece1ed36d37e37cdde3ce43b17ea4e9192ec11289:f9347ca7", "wss://example.relay"],
    // 根种类
    ["K", "30023"],
    // 根事件作者
    ["P", "3c9849383bdea883b0bd16fece1ed36d37e37cdde3ce43b17ea4e9192ec11289", "wss://example.relay"]

    // 父事件地址（对于顶级评论与根相同）
    ["a", "30023:3c9849383bdea883b0bd16fece1ed36d37e37cdde3ce43b17ea4e9192ec11289:f9347ca7", "wss://example.relay"],
    // 当父事件是可替换或可寻址的时，还包括引用其 ID 的 `e` 标签
    ["e", "5b4fc7fed15672fefe65d2426f67197b71ccc82aa0cc8a9e94f683eb78e07651", "wss://example.relay"],
    // 父事件种类
    ["k", "30023"],
    // 父事件作者
    ["p", "3c9849383bdea883b0bd16fece1ed36d37e37cdde3ce43b17ea4e9192ec11289", "wss://example.relay"]
  ]
  // 其他字段
}
```

对 [NIP-94](94_ZH.md) 文件的评论如下所示：

```jsonc
{
  "kind": 1111,
  "content": "很棒的文件！",
  "tags": [
    // 顶级评论具有相同范围并回复地址或 ID
    ["E", "768ac8720cdeb59227cf95e98b66560ef03d8bc9a90d721779e76e68fb42f5e6", "wss://example.relay", "3721e07b079525289877c366ccab47112bdff3d1b44758ca333feb2dbbbbe5bb"],
    // 根种类
    ["K", "1063"],
    // 根事件作者
    ["P", "3721e07b079525289877c366ccab47112bdff3d1b44758ca333feb2dbbbbe5bb"],

    // 父事件 ID（对于顶级评论与根相同）
    ["e", "768ac8720cdeb59227cf95e98b66560ef03d8bc9a90d721779e76e68fb42f5e6", "wss://example.relay", "3721e07b079525289877c366ccab47112bdff3d1b44758ca333feb2dbbbbe5bb"],
    // 父种类
    ["k", "1063"],
    ["p", "3721e07b079525289877c366ccab47112bdff3d1b44758ca333feb2dbbbbe5bb"]
  ]
  // 其他字段
}
```

对评论的回复如下所示：

```jsonc
{
  "kind": 1111,
  "content": "这是对\"很棒的文件！\"的回复",
  "tags": [
    // nip-94 文件事件 ID
    ["E", "768ac8720cdeb59227cf95e98b66560ef03d8bc9a90d721779e76e68fb42f5e6", "wss://example.relay", "fd913cd6fa9edb8405750cd02a8bbe16e158b8676c0e69fdc27436cc4a54cc9a"],
    // 根种类
    ["K", "1063"],
    ["P", "fd913cd6fa9edb8405750cd02a8bbe16e158b8676c0e69fdc27436cc4a54cc9a"],

    // 父事件
    ["e", "5c83da77af1dec6d7289834998ad7aafbd9e2191396d75ec3cc27f5a77226f36", "wss://example.relay", "93ef2ebaaf9554661f33e79949007900bbc535d239a4c801c33a4d67d3e7f546"],
    // 父种类
    ["k", "1111"],
    ["p", "93ef2ebaaf9554661f33e79949007900bbc535d239a4c801c33a4d67d3e7f546"]
  ]
  // 其他字段
}
```

对网站 URL 的评论如下所示：

```jsonc
{
  "kind": 1111,
  "content": "不错的文章！",
  "tags": [
    // 引用根 URL
    ["I", "https://abc.com/articles/1"],
    // 根"种类"：对于 URL
    ["K", "web"],

    // 父引用（对于顶级评论与根相同）
    ["i", "https://abc.com/articles/1"],
    // 父"种类"：对于 URL
    ["k", "web"]
  ]
  // 其他字段
}
```

播客评论示例：

```jsonc
{
  "id": "80c48d992a38f9c445b943a9c9f1010b396676013443765750431a9004bdac05",
  "pubkey": "252f10c83610ebca1a059c0bae8255eba2f95be4d1d7bcfa89d7248a82d9f111",
  "kind": 1111,
  "content": "这是一个很棒的集！",
  "tags": [
    // 播客集引用
    ["I", "podcast:item:guid:d98d189b-dc7b-45b1-8720-d4b98690f31f", "https://fountain.fm/episode/z1y9TMQRuqXl2awyrQxg"],
    // 播客集类型
    ["K", "podcast:item:guid"],

    // 与上面的"I"标签相同的值，因为这是顶级评论（不是对评论的回复）
    ["i", "podcast:item:guid:d98d189b-dc7b-45b1-8720-d4b98690f31f", "https://fountain.fm/episode/z1y9TMQRuqXl2awyrQxg"],
    ["k", "podcast:item:guid"]
  ]
  // 其他字段
}
```

对播客评论的回复：

```jsonc
{
  "kind": 1111,
  "content": "我在回复上面的评论。",
  "tags": [
    // 播客集引用
    ["I", "podcast:item:guid:d98d189b-dc7b-45b1-8720-d4b98690f31f", "https://fountain.fm/episode/z1y9TMQRuqXl2awyrQxg"],
    // 播客集类型
    ["K", "podcast:item:guid"],

    // 这是对上面评论的引用
    ["e", "80c48d992a38f9c445b943a9c9f1010b396676013443765750431a9004bdac05", "wss://example.relay", "252f10c83610ebca1a059c0bae8255eba2f95be4d1d7bcfa89d7248a82d9f111"],
    // 父评论种类
    ["k", "1111"]
    ["p", "252f10c83610ebca1a059c0bae8255eba2f95be4d1d7bcfa89d7248a82d9f111"]
  ]
  // 其他字段
}
```
