NIP-19
======

bech32 编码实体
-----------------------

`草案` `可选`

本 NIP 标准化了可用于在客户端中显示密钥、ID 和其他信息的 bech32 格式字符串。这些格式不应在核心协议中的任何地方使用，它们仅用于向用户显示、复制粘贴、共享、渲染二维码和输入数据。

建议 ID 和密钥以十六进制或二进制格式存储，因为这些格式更接近核心协议中实际必须使用的格式。

## 裸密钥和 ID

为了防止私钥、公钥和事件 ID 之间的混淆和混合，它们都是 32 字节字符串。可以为这些实体中的每一个使用具有不同前缀的 bech32-（非 m）编码。

这些是可能的 bech32 前缀：

  - `npub`：公钥
  - `nsec`：私钥
  - `note`：笔记 ID

示例：十六进制公钥 `3bf0c63fcb93463407af97a5e5ee64fa883d107ef9e558472c4eb9aaaefa459d` 转换为 `npub180cvv07tjdrrgpa0j7j7tmnyl2yr6yr7l8j4s3evf6u64th6gkwsyjh6w6`。

密钥和 ID 的 bech32 编码不应在标准 NIP-01 事件格式内或过滤器内使用，它们仅用于更人性化的显示和输入。客户端现在仍应接受十六进制和 npub 格式的密钥，并在内部转换。

## 带有额外元数据的可共享标识符

当共享档案或事件时，应用程序可能决定包含中继器信息和其他元数据，以便其他应用程序可以更轻松地定位和显示这些实体。

对于这些事件，内容是 `TLV`（类型-长度-值）的二进制编码列表，其中 `T` 和 `L` 各为 1 字节（`uint8`，即 0-255 范围内的数字），`V` 为 `L` 指示大小的字节序列。

这些是带有 `TLV` 的可能 bech32 前缀：

  - `nprofile`：nostr 档案
  - `nevent`：nostr 事件
  - `naddr`：nostr _可寻址事件_ 坐标
  - `nrelay`：nostr 中继器（已弃用）

这些可能的标准化 `TLV` 类型在此指示：

- `0`：`special`
  - 取决于 bech32 前缀：
    - 对于 `nprofile`，它将是档案公钥的 32 字节
    - 对于 `nevent`，它将是事件 ID 的 32 字节
    - 对于 `naddr`，它是被引用事件的标识符（`"d"` 标签）。对于普通可替换事件使用空字符串。
- `1`：`relay`
  - 对于 `nprofile`、`nevent` 和 `naddr`，_可选地_，更可能找到实体（档案或事件）的中继器，编码为 ascii
  - 这可以包含多次
- `2`：`author`
  - 对于 `naddr`，事件公钥的 32 字节
  - 对于 `nevent`，_可选地_，事件公钥的 32 字节
- `3`：`kind`
  - 对于 `naddr`，种类的 32 位无符号整数，大端序
  - 对于 `nevent`，_可选地_，种类的 32 位无符号整数，大端序

## 示例

- `npub10elfcs4fr0l0r8af98jlmgdh9c8tcxjvz9qkw038js35mp4dma8qzvjptg` 应该解码为公钥十六进制 `7e7e9c42a91bfef19fa929e5fda1b72e0ebc1a4c1141673e2794234d86addf4e`，反之亦然
- `nsec1vl029mgpspedva04g90vltkh6fvh240zqtv9k0t9af8935ke9laqsnlfe5` 应该解码为私钥十六进制 `67dea2ed018072d675f5415ecfaed7d2597555e202d85b3d65ea4e58d2d92ffa`，反之亦然
- `nprofile1qqsrhuxx8l9ex335q7he0f09aej04zpazpl0ne2cgukyawd24mayt8gpp4mhxue69uhhytnc9e3k7mgpz4mhxue69uhkg6nzv9ejuumpv34kytnrdaksjlyr9p` 应该解码为具有以下 TLV 项的档案：
  - 公钥：`3bf0c63fcb93463407af97a5e5ee64fa883d107ef9e558472c4eb9aaaefa459d`
  - 中继器：`wss://r.x.com`
  - 中继器：`wss://djbas.sadkb.com`

## 注意事项

- `npub` 密钥不得在 NIP-01 事件或 NIP-05 JSON 响应中使用，那里只支持十六进制格式。
- 当解码 bech32 格式字符串时，应该忽略不被识别或支持的 TLV，而不是导致错误。
