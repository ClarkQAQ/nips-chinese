NIP-54
======

维基
----

`草案` `可选`

本 NIP 定义了 `kind:30818`（一个_可寻址事件_）用于特定主题的描述（或百科全书条目），预期多人会写关于完全相同主题的文章，要么有小的变化，要么有完全独立的内容。

文章通过小写、标准化的 ASCII `d` 标签识别。

## 文章
```json
{
  "content": "维基是由其自身受众协作编辑和管理的超文本出版物。",
  "tags": [
    ["d", "wiki"],
    ["title", "维基"],
  ]
}
```

## `d` 标签标准化规则

- 任何非字母字符必须转换为 `-`。
- 所有字母必须转换为小写。

## 内容

`content` 应该是 Asciidoc，具有两个额外功能：**维基链接**和 **nostr:...** 链接。

与链接到外部网页的普通 Asciidoc 链接 `http://example.com[]` 不同，维基链接 `[[]]` 链接到维基中的其他文章。在这种情况下，维基是整个 Nostr。点击维基链接应该使客户端向中继器请求具有等于该维基链接目标的 `d` 标签的事件。

维基链接可以采用这两种形式：

  1. `[[Target Page]]` -- 在这种情况下，它将链接到页面 `target-page`（根据上面的 `d` 标签标准化规则）并显示为 `Target Page`；
  2. `[[target page|see this]]` -- 在这种情况下，它将链接到页面 `target-page`，但将显示为 `see this`。

根据 [NIP-21](21.md)，`nostr:...` 链接应该链接到档案或任意 Nostr 事件。虽然不建议链接到文章的特定版本 -- 相反应该首选 _维基链接_ 语法，因为应该让读者和他们的客户端决定他们想要阅读任何给定文章的哪个版本。

## 可选额外标签

  - `title`：当显示标题应该与 `d` 标签不同时。
  - `summary`：用于在列表中显示。
  - `a` 和 `e`：用于引用维基文章分叉的原始事件。

## 合并请求

事件 `kind:818` 表示从分叉文章合并到源的请求。它指向一个公钥并引用原始文章和修改的事件。

[插入事件示例]

## 重定向

事件 `kind:30819` 也被定义为代表"维基重定向"，即如果有人认为 `Shell structure` 应该重定向到 `Thin-shell structure`，他们可以发出这些事件之一而不是复制内容。这些事件可以用于在客户端之间自动重定向文章，也可以用于生成众包的"消歧"页面（[在维基百科中很常见](https://en.wikipedia.org/wiki/Help:Disambiguation)）。

[插入事件示例]

## 如何决定显示哪篇文章

由于每个给定名称可能有许多文章，客户端必须进行某种优先级排序。这方面的标准应该在用户和客户端之间有所不同，但下面描述了一些可以使用的方法：

### 反应

[NIP-25](25.md) 反应非常简单，可以用来在维基文章作者和他们的内容之间创建简单的信任网络。虽然只是计算原始的"喜欢"数量是无效的，但用 `+` 对任何维基文章事件做出反应可以被解释为对该特定文章的推荐和对该文章作者的部分推荐。当遵循 2 或 3 级深度推荐时，突然大部分文章可能会有某种形式的标记。

### 中继器

可以使用 kind 10102 创建 [NIP-51](51.md) 中继器列表，然后由维基客户端使用，以确定首先在哪里查询文章，并相对于从其他中继器获取的其他事件对这些进行不同的排名。

### 联系人列表

[NIP-02](02.md) 联系人列表可以形成推荐系统的基础，然后通过嵌套查询扩展中继器列表和反应列表。这些列表只是一个好的起点，因为它们如此广泛。

### 维基相关联系人列表

[NIP-51](51.md) 列表也可以用来创建仅在维基作者身份或维基策展身份上下文中受信任的用户列表。

## 分叉
维基事件可以用 `fork` 标记标记其他维基事件，以指定此事件来自不同版本。应该使用 `a` 和 `e` 标签并应用 `fork` 标记，以识别它分叉的确切版本。

## 延迟
维基事件可以用 `defer` 标记标记其他维基事件，以表示它认为别人的条目是自身的"更好"版本。如果使用 `defer` 标记，应该使用 `a` 和 `e` 标签。

这是比 `+` 反应更强的信任信号。

当用户编辑别人的条目时，此标记很有用；如果原作者包含编辑者的更改，而编辑者不想保持/维护独立版本，`link` 标签实际上可以被视为编辑者版本的"删除"，并将该公钥的 WoT 权重放在原作者版本后面。

## 为什么是 Asciidoc？

维基文本是[垃圾](nostr:nevent1qqsqt0gcggry60n72uglhuhypdlmr2dm6swjj69jex5v530gcpazlzsprpmhxue69uhhyetvv9ujumn0wdmksetjv5hxxmmdqy28wumn8ghj7un9d3shjtnyv9kh2uewd9hsygpm7rrrljungc6q0tuh5hj7ue863q73qlheu4vywtzwhx42a7j9n5ueneex)，而 Markdown 不够强大（除了过于自由形式和未指定，并且容易在将来产生不兼容性）。

Asciidoc 有严格的规范，在许多语言中有多个实现，并支持在维基文章中非常必要的功能，如 _侧边栏_、_表格_（单元格内有丰富标记）、许多级别的 _标题_、_脚注_、_上标_ 和 _下标_ 标记以及 _描述列表_。在其纯文本格式中它也可以说比 Markdown 更容易阅读（当然比维基文本好得多）。

## 附录 1：合并请求
用户可以通过创建 `kind:818` 事件来请求其他用户将他们的条目合并到别人的条目中。

```json
{
  "content": "我添加了关于如何制作热冰淇淋的信息",
  "kind": 818,
  "tags": [
    [ "a", "30818:<目标公钥>:hot-ice-creams", "<中继器 URL>" ],
    [ "e", "<进行修改的版本>", "<中继器 URL>" ],
    [ "p", "<目标公钥>" ],
    [ "e", "<要合并的版本>", "<中继器 URL>", "source" ]
  ]
}
```

`.content`：详细说明为什么请求此合并的可选解释。
`a` 标签：应该修改的文章标签（即此合并请求的目标）。
`e` 标签：此修改基于的文章的可选版本
带有 `source` 标记的 `e` 标签：应该合并的事件的 ID。此事件 ID 必须是本 NIP 中定义的 `kind:30818`。

目标公钥是被请求将某些内容合并到他们文章中的公钥，可以创建标记 `kind:818` 事件的 [[NIP-25]] 反应，使用 `+` 或 `-`
